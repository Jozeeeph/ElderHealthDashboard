<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport Médical Patient</title>

    {# Bootstrap CSS #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    {# Bootstrap Icons #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    {# CSS personnalisés #}
    <link rel="stylesheet" href="{{ asset('css/patient.css') }}?v=20260214-notif1">
    <link rel="stylesheet" href="{{ asset('css/patient-rendezvous.css') }}?v=20260214-7">
</head>

{% block body %}
	<div class="patient-app">
		<style>
			.report-page {
				background: linear-gradient(180deg, #f7fafc 0%, #eef7f2 60%, #ffffff 100%);
				border-radius: 20px;
				padding: 14px;
			}

			.report-hero {
				display: flex;
				justify-content: space-between;
				align-items: flex-start;
				flex-wrap: wrap;
				gap: 10px;
				background: linear-gradient(130deg, #0f766e 0%, #0891b2 50%, #2563eb 100%);
				border-radius: 16px;
				padding: 12px;
				color: #f8fafc;
			}

			.report-title {
				font-size: 1.12rem;
				font-weight: 800;
				margin: 0 0 4px;
			}

			.report-subtitle {
				margin: 0;
				color: rgba(248, 250, 252, 0.9);
				font-weight: 500;
				font-size: 0.86rem;
			}

			.report-chip {
				display: inline-flex;
				align-items: center;
				gap: 6px;
				border-radius: 999px;
				padding: 6px 10px;
				border: 1px solid rgba(248, 250, 252, 0.25);
				background: rgba(255, 255, 255, 0.14);
				font-size: 0.76rem;
				font-weight: 700;
				margin-top: 6px;
			}

			.report-shell {
				margin-top: 10px;
				background: #ffffff;
				border: 1px solid #dbe7ee;
				border-radius: 14px;
				box-shadow: 0 10px 24px rgba(15, 23, 42, 0.06);
				padding: 13px;
			}

			.report-grid {
				display: grid;
				gap: 10px;
				grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
			}

			.report-metric {
				border: 1px solid #dbe7ee;
				border-radius: 14px;
				padding: 10px 12px;
				background: #f8fcfa;
			}

			.report-label {
				font-size: 0.72rem;
				text-transform: uppercase;
				letter-spacing: 0.06em;
				color: #64748b;
				font-weight: 700;
			}

			.report-value {
				margin-top: 4px;
				color: #0f172a;
				font-size: 0.95rem;
				font-weight: 800;
			}

			.report-block {
				margin-top: 10px;
				border: 1px solid #dbe7ee;
				border-radius: 12px;
				background: #fcfffe;
				padding: 12px;
			}

			.report-block h3 {
				margin: 0 0 8px;
				font-size: 1rem;
				font-weight: 800;
				color: #0f172a;
			}

			.report-block p {
				margin: 0;
				color: #1e293b;
				line-height: 1.55;
				white-space: pre-wrap;
			}
		</style>
		{% include 'FrontOffice/patient/_header.html.twig' %}

		<main class="patient-main report-page">
			<section class="report-hero">
				<div>
					<h1 class="report-title">Rapport medical</h1>
					<p class="report-subtitle">Synthese de votre etat de sante et recommandations de suivi</p>
					<div class="report-chip">
						<i class="bi bi-journal-medical"></i>
						Consultation {{ rapport.consultation.id }}
					</div>
				</div>
				<div class="report-chip">
					<i class="bi bi-heart-pulse"></i>
					Bon retablissement
				</div>
			</section>

			<section class="report-shell">
				<div class="report-grid">
					<div class="report-metric">
						<div class="report-label">Gravite</div>
						<div class="report-value">{{ rapport.niveauGravite }}</div>
					</div>
					<div class="report-metric">
						<div class="report-label">Date du rapport</div>
						<div class="report-value">{{ rapport.dateRapport ? rapport.dateRapport|date('d/m/Y H:i') : '-' }}</div>
					</div>
				</div>

				<section class="report-block">
					<h3><i class="bi bi-clipboard2-pulse me-1"></i>Diagnostic</h3>
					<p>{{ rapport.diagnostic }}</p>
				</section>

				<section class="report-block">
					<h3><i class="bi bi-lightbulb me-1"></i>Recommandations</h3>
					<p>{{ rapport.recommandations }}</p>
				</section>

				{% if rapport.fichierPath %}
					<section class="report-block">
						<h3><i class="bi bi-paperclip me-1"></i>Piece jointe</h3>
						<p>
							<a class="btn ghost" href="{{ asset(rapport.fichierPath) }}" target="_blank" rel="noopener">Ouvrir le fichier</a>
						</p>
					</section>
				{% endif %}

				<div class="actions mt-3">
					<a class="btn primary" href="{{ path('patient_rapport_pdf', {'id': rapport.idRapport}) }}">Telecharger PDF</a>
					<a class="btn ghost" href="{{ path('patient_consultations') }}">Retour</a>
				</div>
			</section>
		</main>
	</div>
{% endblock %}
