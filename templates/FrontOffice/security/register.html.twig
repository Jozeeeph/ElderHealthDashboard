{% extends 'FrontOffice/base.html.twig' %}
{% block title %}Register{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/register.css') }}">
    <link rel="stylesheet" href="{{ asset('css/public-site.css') }}">
{% endblock %}

{% block body %}
<div class="register-page">

    <div class="register-wrapper">

        <div class="register-card">

            <div class="register-header">
                <h1>Cr√©er un compte</h1>
                <p>Rejoignez la plateforme Elder HealthCare</p>
            </div>

            {{ form_start(form, {'attr': {'id': 'registrationForm'}}) }}

            <div class="row g-4">

                <div class="col-md-6">
                    {{ form_row(form.email) }}
                </div>

                <div class="col-md-6">
                    {{ form_row(form.roleMetier) }}
                </div>

                <div class="col-md-6">
                    {{ form_row(form.nom) }}
                </div>

                <div class="col-md-6">
                    {{ form_row(form.prenom) }}
                </div>

                <div class="col-md-12">
                    {{ form_row(form.adresse) }}
                </div>

                <div class="col-md-4">
                    {{ form_row(form.age) }}
                </div>

                <div class="col-md-4">
                    {{ form_row(form.dateNaissance) }}
                </div>

                <div class="col-md-4">
                    {{ form_row(form.numeroTelephone) }}
                </div>

                <div class="col-md-6">
                    {{ form_row(form.cin) }}
                </div>

            </div>

            <!-- ROLE SECTIONS -->
            <div id="patientFields" class="role-section">
                <h5>üë§ Espace Patient</h5>
                {{ form_row(form.dossierMedicalFile) }}
            </div>

            <div id="medicalFields" class="role-section">
                <h5>ü©∫ Personnel M√©dical</h5>
                <div class="row g-3">
                    <div class="col-md-6">{{ form_row(form.cvFile) }}</div>
                    <div class="col-md-6">{{ form_row(form.certificationFile) }}</div>
                    <div class="col-md-6">{{ form_row(form.hopitalAffectation) }}</div>
                    <div class="col-md-6">{{ form_row(form.nbAnneeExperience) }}</div>
                    <div class="col-md-6">{{ form_row(form.specialite) }}</div>
                    <div class="col-md-6">{{ form_row(form.fonction) }}</div>
                </div>
            </div>

            <div id="ownerFields" class="role-section">
                <h5>üè• Propri√©taire M√©dicaux</h5>
                <div class="row g-3">
                    <div class="col-md-6">{{ form_row(form.patante) }}</div>
                    <div class="col-md-6">{{ form_row(form.numeroFix) }}</div>
                </div>
            </div>

            <div class="mt-4">
                {{ form_row(form.password) }}
            </div>

            <button class="btn btn-register mt-4 w-100">
                Envoyer la demande
            </button>

            {{ form_rest(form) }}
            {{ form_end(form) }}

            <div class="login-link text-center mt-4">
                <a href="{{ path('app_login') }}">D√©j√† un compte ? Se connecter</a>
            </div>

        </div>
    </div>
</div>

<script>
(function(){
  const form = document.getElementById('registrationForm');
  const roleSelect = form?.querySelector('select[name$="[roleMetier]"]');
  const patient = document.getElementById('patientFields');
  const medical = document.getElementById('medicalFields');
  const owner = document.getElementById('ownerFields');

  function hideAll(){
    if(patient) patient.style.display = 'none';
    if(medical) medical.style.display = 'none';
    if(owner) owner.style.display = 'none';
  }

  function update(){
    hideAll();
    const v = roleSelect?.value;
    if(v === 'PATIENT') patient.style.display = 'block';
    if(v === 'PERSONNEL_MEDICAL') medical.style.display = 'block';
    if(v === 'PROPRIETAIRE_MEDICAUX') owner.style.display = 'block';
  }

  roleSelect?.addEventListener('change', update);
  update();
})();
</script>

{% endblock %}
