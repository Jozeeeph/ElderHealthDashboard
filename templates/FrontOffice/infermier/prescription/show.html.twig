{% block stylesheets %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{{ asset('css/infermier.css') }}">
{% endblock %}

{% block body %}
<div class="nurse-app">
    {% include 'FrontOffice/infermier/_header.html.twig' %}

    <main class="nurse-main">
        <style>
            .rx-page{
                background:
                    radial-gradient(circle at 12% 10%, rgba(56, 189, 248, 0.2), transparent 40%),
                    radial-gradient(circle at 88% 18%, rgba(245, 158, 11, 0.12), transparent 42%),
                    linear-gradient(180deg, #f7fbff 0%, #fbf6ef 55%, #ffffff 100%);
                border-radius: 22px;
                padding: 18px;
            }
            .rx-hero{
                display:flex;
                align-items:center;
                justify-content:space-between;
                gap:16px;
                padding:18px 20px;
                border-radius:18px 26px 18px 26px;
                background: linear-gradient(135deg, #e6f6ff 0%, #fff1dd 60%, #ffffff 100%);
                border:1px solid #e7eef3;
                box-shadow:0 12px 26px rgba(15, 23, 42, 0.08);
            }
            .rx-hero h2{
                margin:0;
                font-size:1.5rem;
                font-weight:800;
                color:#153243;
            }
            .rx-hero .meta{
                margin-top:6px;
                font-weight:700;
                color:#5b6b74;
            }
            .rx-grid{
                margin-top:16px;
                display:grid;
                grid-template-columns: 1.05fr .95fr;
                gap:16px;
            }
            .rx-card{
                background:#ffffff;
                border:1px solid #e5edf2;
                border-radius:16px 26px 16px 26px;
                box-shadow:0 16px 36px rgba(15,23,42,.1);
                padding:18px;
                position:relative;
                overflow:hidden;
            }
            .rx-card::after{
                content:"";
                position:absolute;
                top:0;
                left:0;
                width:100%;
                height:4px;
                background: linear-gradient(90deg, #38bdf8, #60a5fa, #f59e0b);
            }
            .rx-card h3{
                margin:0 0 12px;
                font-weight:800;
                color:#153243;
            }
            .rx-chip{
                display:inline-flex;
                align-items:center;
                gap:8px;
                padding:8px 12px;
                border-radius:12px;
                background:#f1f7fb;
                border:1px solid #d8e6f1;
                color:#1f4b5a;
                font-weight:700;
                font-size:.85rem;
                margin:6px 6px 0 0;
            }
            .rx-section{
                margin-top:16px;
                display:grid;
                gap:12px;
            }
            .rx-panel{
                background:#ffffff;
                border:1px solid #e9e2d4;
                border-radius:16px;
                padding:16px;
                box-shadow:0 10px 20px rgba(15,23,42,.08);
                position:relative;
            }
            .rx-panel::before{
                content:"";
                position:absolute;
                left:0;
                top:0;
                bottom:0;
                width:6px;
                background: linear-gradient(180deg, #38bdf8, #f59e0b);
                border-radius:16px 0 0 16px;
            }
            .rx-panel strong{
                display:block;
                margin-bottom:6px;
                color:#153243;
                padding-left:10px;
            }
            .rx-panel p{
                padding-left:10px;
            }
            .rx-actions{
                display:flex;
                flex-wrap:wrap;
                gap:8px;
            }
            .rx-actions .btn-sm{
                border-radius:999px;
            }
            @media (max-width: 980px){
                .rx-grid{
                    grid-template-columns: 1fr;
                }
            }
        </style>

        <div class="rx-page">
            <section class="rx-hero">
                <div>
                    <h2>Prescription</h2>
                    <div class="meta">Consultation {{ consultation.id }} - Dossier patient</div>
                </div>
                <div class="rx-actions">
                    <a class="btn-sm btn-primary" href="{{ path('front_infermier_prescription_edit', {'id': prescription.idPrescription}) }}">Modifier</a>
                    <a class="btn-sm btn-secondary" href="{{ path('front_infermier_prescription_pdf', {'id': prescription.idPrescription}) }}">PDF</a>
                    <a class="btn-sm btn-secondary" href="{{ path('front_infermier_consultation_index') }}">Retour</a>
                </div>
            </section>

            <section class="rx-grid">
                <div class="rx-card">
                    <h3>Consultation</h3>
                    <span class="rx-chip">Patient: {{ consultation.patient.prenom }} {{ consultation.patient.nom }}</span>
                    <span class="rx-chip">Type: {{ consultation.typeConsultation }}</span>
                    <span class="rx-chip">Date: {{ consultation.dateConsultation ? consultation.dateConsultation|date('d/m/Y') : '-' }}</span>
                    <span class="rx-chip">Heure: {{ consultation.heureConsultation ? consultation.heureConsultation|date('H:i') : '-' }}</span>
                </div>

                <div class="rx-card">
                    <h3>Details prescription</h3>
                    <span class="rx-chip">Frequence: {{ prescription.frequence }}</span>
                    <span class="rx-chip">Dosage: {{ prescription.dosage }}</span>
                    <span class="rx-chip">Duree: {{ prescription.dureeTraitement }}</span>
                    <span class="rx-chip">Periode: {{ prescription.dateDebut ? prescription.dateDebut|date('d/m/Y') : '-' }} - {{ prescription.dateFin ? prescription.dateFin|date('d/m/Y') : '-' }}</span>
                </div>
            </section>

            <section class="rx-section">
                <div class="rx-panel">
                    <strong>Medicaments</strong>
                    <p>{{ prescription.medicaments }}</p>
                </div>
                <div class="rx-panel">
                    <strong>Consignes</strong>
                    <p>{{ prescription.consignes ?: '-' }}</p>
                </div>
            </section>

            <section class="consultation-actions mt-3">
                <form method="post" action="{{ path('front_infermier_prescription_delete', {'id': prescription.idPrescription}) }}" onsubmit="return confirm('Supprimer cette prescription ?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete_prescription_' ~ prescription.idPrescription) }}">
                    <button class="btn btn-danger btn-sm" type="submit">Supprimer</button>
                </form>
            </section>
        </div>
    </main>
</div>
{% endblock %}
